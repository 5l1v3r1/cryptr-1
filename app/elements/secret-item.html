<dom-module id="secret-item">
	<style>
		:host {
		}
		.flex {
			@apply(--layout-flex);
		}
		.center {
			height: calc(100vh - 64px);
			@apply(--layout-horizontal);
			@apply(--layout-center-center);
		}
		.items {
			@apply(--layout-vertical);
		}
		.horizontal {
			@apply(--layout-horizontal);
		}
	</style>
	<template>
		<iron-ajax id="getSecrets"
			url="{{getSecretsURL}}"
			handle-as="json"
			headers="{{header}}"
			on-error="_getError"
			on-response="_getSuccess"
			last-response="{{response}}">
		</iron-ajax>

		<div class="flex">
			<div class="center">
				<div class="items">
					<template is="dom-repeat" items="{{data}}">
						<div class="horizontal">
							<paper-input value="{{item.key}}" label="Name" no-label-float style="width: 100px"></paper-input>
							<paper-input value="{{item.value}}" label="Value" no-label-float style="width: 100px"></paper-input>
						</div>
					</template>
				</div>
			</div>
		</div>
	</template>

	<script>
	Polymer({
		is: "secret-item",
		properties: {
			secrets: Object,
			header: Object,
			location: {
				type: String,
				observer: '_watchLocation'
			},
			route: {
				type: String,
				observer: '_watchRoute'
			},
			data: {
				type: Array,
				value: []
			}
		},
		_watchLocation: function() {
			this.getSecretsURL = app.url + 'v1/' + this.location;
		},
		_watchRoute: function() {
			if (this.route == 'secret/' + this.location) this.$.getSecrets.generateRequest();
		},
		_getError: function(e) {
			console.log('ERROR: ', e);
		},
		_getSuccess: function(e) {
			console.log('SUCCESS: ', this.response);
			this.data = [];
			for (var key in this.response.data) {
				this.push('data', {key: key, value: this.response.data[key]});
			}
			console.log(this.data);
		}
	});
	</script>
</dom-module>